- name: "Aguardando conex√£o..."
  hosts: localhost
  connection: local
  gather_facts: False
  vars:
    acao: "{{ acao }}"

  tasks:
    - name: "Start instances"
      amazon.aws.ec2_instance:
        access_key: "{{ lookup('env','AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env','AWS_SECRET_ACCESS_KEY') }}"
        instance_ids: "i-0cb3321612cda5b32"
        state: started
        wait: True
      when: acao == "Ligar"

    - name: "Stop instances"
      amazon.aws.ec2_instance:
        access_key: "{{ lookup('env','AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env','AWS_SECRET_ACCESS_KEY') }}"
        instance_ids: "i-0cb3321612cda5b32"
        state: stopped
        wait: True
      when: acao == "Desligar"
