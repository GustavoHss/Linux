- name: "Aguardando conex√£o..."
  hosts:
    localhost
    "{{ host }}"
  connection: local
  gather_facts: False

  tasks:
    - ansible.builtin.debug:
        msg:
          "{{ ansible_facts }}"
    
    - name: "Start instances"
      amazon.aws.ec2_instance:
        access_key: "{{ lookup('env','AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env','AWS_SECRET_ACCESS_KEY') }}"
        instance_ids: "i-0cb3321612cda5b32"
        region: "sa-east-1"
        state: started
        wait: True
      when: acao == "Ligar"

    - name: "Stop instances"
      amazon.aws.ec2_instance:
        access_key: "{{ lookup('env','AWS_ACCESS_KEY_ID') }}"
        aws_secret_key: "{{ lookup('env','AWS_SECRET_ACCESS_KEY') }}"
        instance_ids: "i-0cb3321612cda5b32"
        region: "sa-east-1"
        state: stopped
        wait: True
      when: acao == "Desligar"
